# Conference-api

_Для работы приложения необходим запущенный инстанс [MongoDB](https://www.mongodb.com)_.  
_Убедитесь, что Вы указали URI инстанса в файле `utils/config.js`._  

_Пример:_ `mongodb://localhost:27017/api`  

### Первый запуск  


Перед первым запуском приложения необходимо создать базу и заполнить ее информацией из `database_initialization/conferences.json`.
Если Вы находитесь в папке с проектом, сделать это можно следующей командой:  
```
node database_initialization/initDB.js 
```  
## Работа с приложением  
 
#### Запуск  

Для запуска приложения наберите
```
node app/server.js
```
_В конфигурационном файле `utils/config.js` можно указать host и port, на котором будет запущен сервер. Далее подразумевается, 
что сервер принимает запросы на **localhost:9000**._  

#### Запросы к API  

##### Простые запросы. Метод GET  

Для получения данных о всех конференциях достаточно сделать GET запрос на `http://localhost:9000/conferences`.
Сервер вернет Вам информацию о конференциях в виде JSON. Для быстрого получения информации о конкретной конференции 
по ее названию - запрос на `http://localhost:9000/conferences/:title`.

_Пример:_ `http://localhost:9000/conferences/PyTennessee` 

Если Вам необходимо извлечь из базы данные, соответствующие определенным критериям, Вы можете указать их в качестве
параметров запроса в виде  
_<ключ>=<значение>_. 

_Пример:_ `http://localhost:9000/conferences?attendance=300&location.city=Nashville`

Кроме того, в качестве параметров запроса можно указать:
* _limit_ - максимальное количество документов в ответе;
* _offset_ - смещение относительно начала подходящего критериям набора документов.

_Пример:_ `http://localhost:9000/conferences?status=ACCEPTED&offset=5&limit=5`

Таким образом, можно организовать получение данных из базы "по страницам".  

##### "Продвинутые" запросы. Метод POST  

Для более сложных запросов можно обратиться к `http://localhost:9000/conferences` с 
помощью метода POST с телом запроса в виде JSON.

_Пример тела такого запроса:_
```
{
	"query": {
		"dateFinish": {
			"$gt": "2019-02-22T12:00:00.000Z"
		}
	},
	"fields": [
		"title",
		"projects",
		"dateStart",
		"dateFinish"
	],
	"sort": {
		"title": 1
	},
	"limit": 30,
	"offset": 0
}
```
* _query_ - запрос к базе данных MongoDB ([мануал](https://docs.mongodb.com/manual/tutorial/query-documents/));
* _fields_ - поля, которые хотим получить в ответе;
* _sort_ - поля, по которым будет производится сортировка; 
* _limit_ - максимальное количество документов в ответе;
* _offset_ - смещение относительно начала подходящего критериям набора документов.

Все параметры можно опускать. В таком случае им будут присвоены значения по умолчанию:
* _query_ - выбор всех документов из коллекции;
* _fields_ - выбор всех полей;
* _sort_ - не сортировать;
* _limit_ - значение, указанное в `utils/config.js`;
* _offset_ - значение, указанное в `utils/config.js`. 
